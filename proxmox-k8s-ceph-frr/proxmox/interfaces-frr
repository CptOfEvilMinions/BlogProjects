# network interface settings; autogenerated
# Please do NOT modify this file directly, unless you know what
# you're doing.
#
# If you want to manage parts of the network configuration manually,
# please utilize the 'source' or 'source-directory' directives to do
# so.
# PVE will preserve these directives, but will NOT read its network
# configuration from sourced files, so do not attempt to move any of
# the PVE managed interfaces into external files!

auto lo
iface lo inet loopback

auto lo:0
iface lo:0 inet6 static
    address {{ ceph_cluster_net }}::{{ network_entity_titles[inventory_hostname]["id"] }}
    netmask 128
    mtu 9000
# Ceph cluster network

auto lo:1
iface lo:1 inet6 static
    address {{ ceph_public_net }}::{{ network_entity_titles[inventory_hostname]["id"] }}
    netmask 128
    mtu 9000
# Ceph public network

auto eno1
iface eno1 inet static
    mtu 9000
#Ceph 10GB

auto eno2
iface eno2 inet static
    mtu 9000
#Ceph 10Gb

auto eno3
iface eno3 inet manual

auto eno4
iface eno4 inet manual

auto bond0
iface bond0 inet manual
    bond-slaves eno3 eno4
    bond-miimon 100
    bond-mode 802.3ad
    bond-xmit-hash-policy layer2+3

auto vmbr1
iface vmbr1 inet static
    address {{ ansible_host }}/24
    gateway {{ ansible_default_ipv4["gateway"] }}
    bridge-ports bond0
    bridge-stp off
    bridge-fd 0
    bridge-vlan-aware yes
    bridge-vids 2-4094

auto vmbr30
iface vmbr30 inet6 manual
    bridge_ports none
    bridge_stp off
    bridge_fd 0
    mtu 9000
# Ceph public network

sleep 5 && post-up /usr/bin/systemctl restart frr.service
source /etc/network/interfaces.d/*
